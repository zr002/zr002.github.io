const _0x5085ed=_0x3428;function _0x3428(_0x211bd4,_0x517020){const _0x34f6dc=_0x34f6();return _0x3428=function(_0x342837,_0x516dff){_0x342837=_0x342837-0x17f;let _0x3c6dff=_0x34f6dc[_0x342837];return _0x3c6dff;},_0x3428(_0x211bd4,_0x517020);}(function(_0x5e385e,_0x56bc89){const _0x4e3f7f=_0x3428,_0xf416b0=_0x5e385e();while(!![]){try{const _0x119fa1=parseInt(_0x4e3f7f(0x1b1))/0x1*(-parseInt(_0x4e3f7f(0x1b0))/0x2)+parseInt(_0x4e3f7f(0x1bf))/0x3+-parseInt(_0x4e3f7f(0x1cb))/0x4*(parseInt(_0x4e3f7f(0x194))/0x5)+-parseInt(_0x4e3f7f(0x1a7))/0x6+parseInt(_0x4e3f7f(0x19f))/0x7+-parseInt(_0x4e3f7f(0x1a6))/0x8*(parseInt(_0x4e3f7f(0x1ba))/0x9)+parseInt(_0x4e3f7f(0x1c8))/0xa;if(_0x119fa1===_0x56bc89)break;else _0xf416b0['push'](_0xf416b0['shift']());}catch(_0x38bd3f){_0xf416b0['push'](_0xf416b0['shift']());}}}(_0x34f6,0x29739));import _0x5ef289 from'/lib/DSViz/RayTracingObject.js';import _0x7ddaff from'/lib/DS/UnitCube2.js';function _0x34f6(){const _0x50ad66=['updateCameraPose','setBindGroup','compute','getBindGroupLayout','8849160kLLdhN','_front','_camera','4OSNKTb','Ray\x20Trace\x20Box\x20Bind\x20Group\x20','_wgWidth','_cameraBuffer','createGeometry','computeProjectiveMain','_sphereData','ceil','ymin','UNIFORM','Cube\x20Buffer\x20','Camera\x20','_focal','_sphereBuffer','byteLength','_cubeData','_cylinderBuffer','_pipelineLayout','computeOrthogonalMain','_wgHeight','updateSize','halfSize','_back','_resolutions','1503235ornwyM','Ray\x20Trace\x20Box\x20Orthogonal\x20Pipeline\x20','createShaders','_down','_isProjective','_box','_pose','_bindGroupLayout','Box\x20','updateCameraFocal','Cylinder\x20Buffer\x20','376656JkXbeZ','_boxBuffer','createBuffer','createBindGroupLayout','dispatchWorkgroups','_computePipeline','queue','48mIzvbJ','1863048jOPVzO','createView','_left','_top','createComputePipeline','_shaderModule','center','_cubeBuffer','writeBuffer','487406MNTPKb','1PTFwGQ','createShaderModule','getName','_device','Ray\x20Trace\x20Box\x20Layout\x20','createBindGroup','COPY_DST','_cylinderData','_imgHeight','246735IAizFG','_canvasFormat','_scales','updateGeometry','_right','751227LqVkdX','Sphere\x20Buffer\x20','COMPUTE','_bindGroup','setPipeline'];_0x34f6=function(){return _0x50ad66;};return _0x34f6();}export default class _0x3adf19 extends _0x5ef289{constructor(_0x265661,_0x1a007e,_0x56695a,_0x24f694=!![]){const _0x4c7836=_0x3428;super(_0x265661,_0x1a007e),this[_0x4c7836(0x199)]=new _0x7ddaff(),this[_0x4c7836(0x1ca)]=_0x56695a,this['_showTexture']=_0x24f694,this[_0x4c7836(0x18b)]={'center':[0x0,0x0,0x0,0x0],'halfSize':0.08},this['_sphereData']={'center':[0.15,0x0,0x0,0x0],'radius':0.1},this[_0x4c7836(0x1b8)]={'center':[-0.5,0x0,0x0,0x0],'radius':0.05,'ymin':-0.125,'ymax':0.125};}async[_0x5085ed(0x180)](){const _0x5d4f95=_0x5085ed;this[_0x5d4f95(0x17f)]=this[_0x5d4f95(0x1b4)][_0x5d4f95(0x1a1)]({'label':_0x5d4f95(0x187)+this['getName'](),'size':this[_0x5d4f95(0x1ca)][_0x5d4f95(0x19a)][_0x5d4f95(0x18a)]+this['_camera'][_0x5d4f95(0x188)][_0x5d4f95(0x18a)]+this[_0x5d4f95(0x1ca)][_0x5d4f95(0x193)][_0x5d4f95(0x18a)],'usage':GPUBufferUsage[_0x5d4f95(0x185)]|GPUBufferUsage['COPY_DST']}),this[_0x5d4f95(0x1b4)]['queue'][_0x5d4f95(0x1af)](this[_0x5d4f95(0x17f)],0x0,this[_0x5d4f95(0x1ca)]['_pose']),this[_0x5d4f95(0x1b4)][_0x5d4f95(0x1a5)][_0x5d4f95(0x1af)](this[_0x5d4f95(0x17f)],this[_0x5d4f95(0x1ca)][_0x5d4f95(0x19a)]['byteLength'],this[_0x5d4f95(0x1ca)][_0x5d4f95(0x188)]),this[_0x5d4f95(0x1b4)][_0x5d4f95(0x1a5)]['writeBuffer'](this['_cameraBuffer'],this[_0x5d4f95(0x1ca)][_0x5d4f95(0x19a)]['byteLength']+this[_0x5d4f95(0x1ca)][_0x5d4f95(0x188)][_0x5d4f95(0x18a)],this[_0x5d4f95(0x1ca)][_0x5d4f95(0x193)]),this['_boxBuffer']=this[_0x5d4f95(0x1b4)][_0x5d4f95(0x1a1)]({'label':_0x5d4f95(0x19c)+this['getName'](),'size':this[_0x5d4f95(0x199)][_0x5d4f95(0x19a)][_0x5d4f95(0x18a)]+this[_0x5d4f95(0x199)][_0x5d4f95(0x1bc)][_0x5d4f95(0x18a)]+this[_0x5d4f95(0x199)][_0x5d4f95(0x1aa)]['byteLength']*0x6,'usage':GPUBufferUsage['UNIFORM']|GPUBufferUsage['COPY_DST']});let _0x48f78b=0x0;this[_0x5d4f95(0x1b4)][_0x5d4f95(0x1a5)][_0x5d4f95(0x1af)](this['_boxBuffer'],_0x48f78b,this[_0x5d4f95(0x199)][_0x5d4f95(0x19a)]),_0x48f78b+=this[_0x5d4f95(0x199)][_0x5d4f95(0x19a)][_0x5d4f95(0x18a)],this[_0x5d4f95(0x1b4)]['queue'][_0x5d4f95(0x1af)](this[_0x5d4f95(0x1a0)],_0x48f78b,this['_box'][_0x5d4f95(0x1bc)]),_0x48f78b+=this[_0x5d4f95(0x199)][_0x5d4f95(0x1bc)][_0x5d4f95(0x18a)],this[_0x5d4f95(0x1b4)][_0x5d4f95(0x1a5)][_0x5d4f95(0x1af)](this[_0x5d4f95(0x1a0)],_0x48f78b,this['_box'][_0x5d4f95(0x1c9)]),_0x48f78b+=this['_box'][_0x5d4f95(0x1c9)][_0x5d4f95(0x18a)],this[_0x5d4f95(0x1b4)]['queue'][_0x5d4f95(0x1af)](this[_0x5d4f95(0x1a0)],_0x48f78b,this[_0x5d4f95(0x199)][_0x5d4f95(0x192)]),_0x48f78b+=this[_0x5d4f95(0x199)][_0x5d4f95(0x192)]['byteLength'],this[_0x5d4f95(0x1b4)][_0x5d4f95(0x1a5)][_0x5d4f95(0x1af)](this[_0x5d4f95(0x1a0)],_0x48f78b,this[_0x5d4f95(0x199)][_0x5d4f95(0x1a9)]),_0x48f78b+=this[_0x5d4f95(0x199)][_0x5d4f95(0x1a9)][_0x5d4f95(0x18a)],this[_0x5d4f95(0x1b4)][_0x5d4f95(0x1a5)][_0x5d4f95(0x1af)](this['_boxBuffer'],_0x48f78b,this[_0x5d4f95(0x199)]['_right']),_0x48f78b+=this[_0x5d4f95(0x199)][_0x5d4f95(0x1be)][_0x5d4f95(0x18a)],this[_0x5d4f95(0x1b4)][_0x5d4f95(0x1a5)][_0x5d4f95(0x1af)](this[_0x5d4f95(0x1a0)],_0x48f78b,this[_0x5d4f95(0x199)][_0x5d4f95(0x1aa)]),_0x48f78b+=this[_0x5d4f95(0x199)]['_top'][_0x5d4f95(0x18a)],this['_device'][_0x5d4f95(0x1a5)][_0x5d4f95(0x1af)](this[_0x5d4f95(0x1a0)],_0x48f78b,this[_0x5d4f95(0x199)][_0x5d4f95(0x197)]),this[_0x5d4f95(0x1ae)]=this['_device'][_0x5d4f95(0x1a1)]({'label':_0x5d4f95(0x186)+this['getName'](),'size':0x30,'usage':GPUBufferUsage[_0x5d4f95(0x185)]|GPUBufferUsage['COPY_DST']});const _0x477ad6=new Float32Array([...this[_0x5d4f95(0x18b)][_0x5d4f95(0x1ad)],this[_0x5d4f95(0x18b)][_0x5d4f95(0x191)],0x0,0x0,0x0,0x0,0x0,0x0,0x0]);this[_0x5d4f95(0x1b4)][_0x5d4f95(0x1a5)][_0x5d4f95(0x1af)](this[_0x5d4f95(0x1ae)],0x0,_0x477ad6),this[_0x5d4f95(0x189)]=this[_0x5d4f95(0x1b4)][_0x5d4f95(0x1a1)]({'label':_0x5d4f95(0x1c0)+this[_0x5d4f95(0x1b3)](),'size':0x30,'usage':GPUBufferUsage[_0x5d4f95(0x185)]|GPUBufferUsage[_0x5d4f95(0x1b7)]});const _0x5aed04=new Float32Array([...this[_0x5d4f95(0x182)][_0x5d4f95(0x1ad)],this['_sphereData']['radius'],0x0,0x0,0x0,0x0,0x0,0x0,0x0]);this[_0x5d4f95(0x1b4)][_0x5d4f95(0x1a5)][_0x5d4f95(0x1af)](this[_0x5d4f95(0x189)],0x0,_0x5aed04),this['_cylinderBuffer']=this[_0x5d4f95(0x1b4)][_0x5d4f95(0x1a1)]({'label':_0x5d4f95(0x19e)+this['getName'](),'size':0x20,'usage':GPUBufferUsage[_0x5d4f95(0x185)]|GPUBufferUsage[_0x5d4f95(0x1b7)]});const _0x1a62e7=new Float32Array([...this['_cylinderData'][_0x5d4f95(0x1ad)],this[_0x5d4f95(0x1b8)]['radius'],this[_0x5d4f95(0x1b8)][_0x5d4f95(0x184)],this[_0x5d4f95(0x1b8)]['ymax'],0x0]);this['_device']['queue']['writeBuffer'](this['_cylinderBuffer'],0x0,_0x1a62e7);}[_0x5085ed(0x1bd)](){const _0x43232d=_0x5085ed;this[_0x43232d(0x1ca)][_0x43232d(0x190)](this['_imgWidth'],this[_0x43232d(0x1b9)]),this[_0x43232d(0x1b4)][_0x43232d(0x1a5)]['writeBuffer'](this[_0x43232d(0x17f)],this[_0x43232d(0x1ca)][_0x43232d(0x19a)]['byteLength']+this['_camera']['_focal'][_0x43232d(0x18a)],this[_0x43232d(0x1ca)][_0x43232d(0x193)]);}['updateBoxPose'](){const _0x11b291=_0x5085ed;this[_0x11b291(0x1b4)][_0x11b291(0x1a5)][_0x11b291(0x1af)](this[_0x11b291(0x1a0)],0x0,this['_box'][_0x11b291(0x19a)]);}['updateBoxScales'](){const _0x1494a8=_0x5085ed;this[_0x1494a8(0x1b4)][_0x1494a8(0x1a5)]['writeBuffer'](this[_0x1494a8(0x1a0)],this[_0x1494a8(0x199)]['_pose'][_0x1494a8(0x18a)],this['_box']['_scales']);}[_0x5085ed(0x1c4)](){const _0x515cdd=_0x5085ed;this[_0x515cdd(0x1b4)]['queue'][_0x515cdd(0x1af)](this['_cameraBuffer'],0x0,this['_camera']['_pose']);}[_0x5085ed(0x19d)](){const _0x3f1cd1=_0x5085ed;this[_0x3f1cd1(0x1b4)]['queue'][_0x3f1cd1(0x1af)](this[_0x3f1cd1(0x17f)],this[_0x3f1cd1(0x1ca)][_0x3f1cd1(0x19a)][_0x3f1cd1(0x18a)],this['_camera']['_focal']);}async[_0x5085ed(0x196)](){const _0x444047=_0x5085ed;let _0x1b20be=await this['loadShader']('/shaders/tracebox2.wgsl');this['_shaderModule']=this[_0x444047(0x1b4)][_0x444047(0x1b2)]({'label':'\x20Shader\x20'+this[_0x444047(0x1b3)](),'code':_0x1b20be}),this[_0x444047(0x19b)]=this[_0x444047(0x1b4)][_0x444047(0x1a2)]({'label':_0x444047(0x1b5)+this[_0x444047(0x1b3)](),'entries':[{'binding':0x0,'visibility':GPUShaderStage[_0x444047(0x1c1)],'buffer':{}},{'binding':0x1,'visibility':GPUShaderStage[_0x444047(0x1c1)],'buffer':{}},{'binding':0x2,'visibility':GPUShaderStage[_0x444047(0x1c1)],'storageTexture':{'format':this[_0x444047(0x1bb)]}},{'binding':0x3,'visibility':GPUShaderStage['COMPUTE'],'buffer':{}},{'binding':0x4,'visibility':GPUShaderStage[_0x444047(0x1c1)],'buffer':{}},{'binding':0x5,'visibility':GPUShaderStage[_0x444047(0x1c1)],'buffer':{}}]}),this[_0x444047(0x18d)]=this[_0x444047(0x1b4)]['createPipelineLayout']({'label':'Ray\x20Trace\x20Box\x20Pipeline\x20Layout','bindGroupLayouts':[this['_bindGroupLayout']]});}async[_0x5085ed(0x1ab)](){const _0x2982db=_0x5085ed;this[_0x2982db(0x1a4)]=this['_device'][_0x2982db(0x1ab)]({'label':_0x2982db(0x195)+this[_0x2982db(0x1b3)](),'layout':this[_0x2982db(0x18d)],'compute':{'module':this[_0x2982db(0x1ac)],'entryPoint':_0x2982db(0x18e)}}),this['_computeProjectivePipeline']=this['_device'][_0x2982db(0x1ab)]({'label':'Ray\x20Trace\x20Box\x20Projective\x20Pipeline\x20'+this[_0x2982db(0x1b3)](),'layout':this[_0x2982db(0x18d)],'compute':{'module':this[_0x2982db(0x1ac)],'entryPoint':_0x2982db(0x181)}});}[_0x5085ed(0x1b6)](_0x498211){const _0x536200=_0x5085ed;this[_0x536200(0x1c2)]=this[_0x536200(0x1b4)]['createBindGroup']({'label':_0x536200(0x1cc)+this[_0x536200(0x1b3)](),'layout':this[_0x536200(0x1a4)][_0x536200(0x1c7)](0x0),'entries':[{'binding':0x0,'resource':{'buffer':this[_0x536200(0x17f)]}},{'binding':0x1,'resource':{'buffer':this['_boxBuffer']}},{'binding':0x2,'resource':_0x498211[_0x536200(0x1a8)]()},{'binding':0x3,'resource':{'buffer':this['_cubeBuffer']}},{'binding':0x4,'resource':{'buffer':this['_sphereBuffer']}},{'binding':0x5,'resource':{'buffer':this[_0x536200(0x18c)]}}]}),this[_0x536200(0x1cd)]=Math[_0x536200(0x183)](_0x498211['width']),this[_0x536200(0x18f)]=Math[_0x536200(0x183)](_0x498211['height']);}[_0x5085ed(0x1c6)](_0x403919){const _0x479647=_0x5085ed;this[_0x479647(0x1ca)]?.[_0x479647(0x198)]?_0x403919[_0x479647(0x1c3)](this['_computeProjectivePipeline']):_0x403919[_0x479647(0x1c3)](this['_computePipeline']),_0x403919[_0x479647(0x1c5)](0x0,this[_0x479647(0x1c2)]),_0x403919[_0x479647(0x1a3)](Math['ceil'](this[_0x479647(0x1cd)]/0x10),Math[_0x479647(0x183)](this[_0x479647(0x18f)]/0x10));}}
